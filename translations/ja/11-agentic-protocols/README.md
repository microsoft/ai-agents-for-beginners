<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "f6600bebb86f72f3f62a9163fcce9566",
  "translation_date": "2025-08-30T10:05:02+00:00",
  "source_file": "11-agentic-protocols/README.md",
  "language_code": "ja"
}
-->
# エージェントプロトコル (MCP, A2A, NLWeb) の活用

[![エージェントプロトコル](../../../translated_images/lesson-11-thumbnail.b6c742949cf1ce2aa0255968d287b31c99b51dfa9c9beaede7c3fbed90e8fcfb.ja.png)](https://youtu.be/X-Dh9R3Opn8)

AIエージェントの利用が拡大するにつれ、標準化、安全性、そしてオープンイノベーションを支えるプロトコルの必要性も高まっています。このレッスンでは、そのニーズに応える3つのプロトコル、Model Context Protocol (MCP)、Agent to Agent (A2A)、および Natural Language Web (NLWeb) について学びます。

## はじめに

このレッスンでは以下を学びます：

• **MCP** がAIエージェントに外部ツールやデータへのアクセスを提供し、ユーザータスクを完了する方法。

• **A2A** が異なるAIエージェント間の通信と協力を可能にする方法。

• **NLWeb** が自然言語インターフェースをウェブサイトに導入し、AIエージェントがコンテンツを発見し、操作できるようにする方法。

## 学習目標

• AIエージェントの文脈で、MCP、A2A、NLWebの**主な目的と利点を特定**する。

• 各プロトコルがLLM、ツール、その他のエージェント間の通信と相互作用をどのように促進するかを**説明**する。

• 複雑なエージェントシステムを構築する際に、各プロトコルが果たす**独自の役割を認識**する。

## Model Context Protocol

**Model Context Protocol (MCP)** は、アプリケーションがLLMにコンテキストやツールを提供するための標準化された方法を提供するオープンスタンダードです。これにより、AIエージェントが一貫した方法でさまざまなデータソースやツールに接続できる「ユニバーサルアダプター」が実現します。

MCPの構成要素、従来のAPI使用との比較による利点、そしてAIエージェントがMCPサーバーをどのように活用するかの例を見ていきましょう。

### MCPの主要構成要素

MCPは**クライアント-サーバーアーキテクチャ**で動作し、主要な構成要素は以下の通りです：

• **ホスト**: LLMアプリケーション（例: VSCodeのようなコードエディタ）で、MCPサーバーへの接続を開始します。

• **クライアント**: ホストアプリケーション内のコンポーネントで、サーバーとの1対1の接続を維持します。

• **サーバー**: 特定の機能を公開する軽量プログラムです。

プロトコルには、MCPサーバーの機能を構成する3つの基本的なプリミティブが含まれています：

• **ツール**: AIエージェントがアクションを実行するために呼び出せる個別のアクションや関数です。例えば、天気サービスが「天気を取得する」ツールを公開したり、eコマースサーバーが「商品を購入する」ツールを公開したりします。MCPサーバーは、各ツールの名前、説明、入出力スキーマを機能リストで広告します。

• **リソース**: MCPサーバーが提供できる読み取り専用のデータ項目やドキュメントで、クライアントが必要に応じて取得できます。例としては、ファイルの内容、データベースのレコード、ログファイルなどがあります。リソースはテキスト（コードやJSONなど）やバイナリ（画像やPDFなど）である場合があります。

• **プロンプト**: より複雑なワークフローを可能にするための提案されたプロンプトを提供する事前定義されたテンプレートです。

### MCPの利点

MCPはAIエージェントにとって以下のような大きな利点を提供します：

• **動的ツール検出**: エージェントはサーバーから利用可能なツールのリストとその説明を動的に受け取ることができます。これにより、従来のAPIのように統合のために静的なコーディングが必要なくなり、APIの変更時にコードを更新する必要がなくなります。MCPは「一度統合すればOK」というアプローチを提供し、適応性を向上させます。

• **LLM間の相互運用性**: MCPは異なるLLM間で動作し、より良いパフォーマンスを評価するためにコアモデルを切り替える柔軟性を提供します。

• **標準化されたセキュリティ**: MCPには標準的な認証方法が含まれており、追加のMCPサーバーへのアクセスを追加する際のスケーラビリティを向上させます。これにより、従来のAPIで必要な異なるキーや認証タイプを管理するよりも簡単になります。

### MCPの例

![MCP Diagram](../../../translated_images/mcp-diagram.e4ca1cbd551444a12e1f0eb300191a036ab01124fce71c864fe9cb7f4ac2a15d.ja.png)

ユーザーがMCPを活用したAIアシスタントを使ってフライトを予約したいとします。

1. **接続**: AIアシスタント（MCPクライアント）が航空会社が提供するMCPサーバーに接続します。

2. **ツール検出**: クライアントが航空会社のMCPサーバーに「どのツールが利用可能ですか？」と尋ねます。サーバーは「フライト検索」や「フライト予約」といったツールを返します。

3. **ツール呼び出し**: ユーザーがAIアシスタントに「ポートランドからホノルルへのフライトを検索してください」と依頼します。AIアシスタントはLLMを使用して「フライト検索」ツールを呼び出し、関連するパラメータ（出発地、目的地）をMCPサーバーに渡します。

4. **実行と応答**: MCPサーバーはラッパーとして機能し、航空会社の内部予約APIに実際の呼び出しを行います。その後、フライト情報（例: JSONデータ）を受け取り、AIアシスタントに返します。

5. **さらなるやり取り**: AIアシスタントがフライトオプションを提示します。ユーザーがフライトを選択すると、アシスタントは同じMCPサーバー上の「フライト予約」ツールを呼び出し、予約を完了します。

## Agent-to-Agent Protocol (A2A)

MCPがLLMとツールを接続することに焦点を当てている一方で、**Agent-to-Agent (A2A) プロトコル**はさらに一歩進み、異なるAIエージェント間の通信と協力を可能にします。A2Aは、異なる組織、環境、技術スタックにまたがるAIエージェントを接続し、共有タスクを完了します。

A2Aの構成要素と利点、そして旅行アプリケーションでの適用例を見ていきましょう。

### A2Aの主要構成要素

A2Aはエージェント間の通信を可能にし、ユーザーのサブタスクを完了するために協力します。プロトコルの各構成要素は以下の通りです：

#### エージェントカード

MCPサーバーがツールのリストを共有するのと同様に、エージェントカードには以下が含まれます：
    ◦ エージェントの名前  
    ◦ **完了する一般的なタスクの説明**  
    ◦ **特定のスキルのリスト**とその説明（他のエージェントや人間のユーザーがそのエージェントを呼び出す理由を理解するため）  
    ◦ エージェントの**現在のエンドポイントURL**  
    ◦ **バージョン**と**機能**（ストリーミング応答やプッシュ通知など）  

#### エージェントエグゼキューター

エージェントエグゼキューターは、**ユーザーチャットのコンテキストをリモートエージェントに渡す役割**を担います。リモートエージェントは、完了すべきタスクを理解するためにこれを必要とします。A2Aサーバーでは、エージェントが自身のLLMを使用して受信リクエストを解析し、内部ツールを使用してタスクを実行します。

#### アーティファクト

リモートエージェントが要求されたタスクを完了すると、その成果物がアーティファクトとして作成されます。アーティファクトには、**エージェントの作業結果**、**完了した内容の説明**、および**プロトコルを通じて送信されたテキストコンテキスト**が含まれます。アーティファクトが送信されると、リモートエージェントとの接続は再び必要になるまで閉じられます。

#### イベントキュー

このコンポーネントは、**更新の処理とメッセージの受け渡し**に使用されます。特に、タスク完了に時間がかかる場合に、エージェント間の接続がタスク完了前に閉じられないようにするため、エージェントシステムの本番環境で重要です。

### A2Aの利点

• **協力の強化**: 異なるベンダーやプラットフォームのエージェントが相互作用し、コンテキストを共有し、協力して作業を行うことを可能にし、従来は分断されていたシステム間でシームレスな自動化を促進します。

• **モデル選択の柔軟性**: 各A2Aエージェントは、リクエストを処理するために使用するLLMを選択できるため、エージェントごとに最適化または微調整されたモデルを使用できます。これは、MCPの一部のシナリオでの単一LLM接続とは異なります。

• **組み込み認証**: 認証はA2Aプロトコルに直接統合されており、エージェント間の相互作用に対する堅牢なセキュリティフレームワークを提供します。

### A2Aの例

![A2A Diagram](../../../translated_images/A2A-Diagram.8666928d648acc2687db4093d7b09ea2a595622f8fe18194a026ee55fc23af8e.ja.png)

旅行予約シナリオを拡張し、今回はA2Aを使用します。

1. **ユーザーからのリクエスト**: ユーザーが「来週ホノルルへの旅行全体を予約してください。フライト、ホテル、レンタカーを含めて」といったリクエストを「旅行エージェント」A2Aクライアント/エージェントに送信します。

2. **旅行エージェントによるオーケストレーション**: 旅行エージェントがこの複雑なリクエストを受け取ります。LLMを使用してタスクを推論し、他の専門エージェントとやり取りする必要があると判断します。

3. **エージェント間通信**: 旅行エージェントはA2Aプロトコルを使用して、航空会社エージェント、ホテルエージェント、レンタカーエージェントなど、異なる企業が作成した専門エージェントに接続します。

4. **タスクの委任実行**: 旅行エージェントは、これらの専門エージェントに特定のタスク（例: 「ホノルル行きのフライトを見つける」「ホテルを予約する」「車をレンタルする」）を送信します。各専門エージェントは、それぞれのLLMを実行し、独自のツールを使用して（これらはMCPサーバーである可能性があります）、予約の特定部分を実行します。

5. **統合された応答**: 下流のエージェントがすべてのタスクを完了すると、旅行エージェントが結果（フライトの詳細、ホテルの確認、レンタカーの予約）をまとめ、ユーザーに包括的なチャット形式の応答を送信します。

## Natural Language Web (NLWeb)

ウェブサイトは長い間、インターネット上で情報やデータにアクセスするための主要な手段でした。

NLWebのさまざまな構成要素、利点、そして旅行アプリケーションを例にしてNLWebがどのように機能するかを見ていきましょう。

### NLWebの構成要素

- **NLWebアプリケーション（コアサービスコード）**: 自然言語の質問を処理するシステムです。プラットフォームのさまざまな部分を接続して応答を生成します。ウェブサイトの自然言語機能を支える**エンジン**と考えることができます。

- **NLWebプロトコル**: ウェブサイトとの自然言語インタラクションのための**基本的なルールセット**です。JSON形式（Schema.orgを使用することが多い）で応答を返します。HTMLがオンラインでドキュメントを共有可能にしたのと同じように、「AI Web」のシンプルな基盤を作ることを目的としています。

- **MCPサーバー（Model Context Protocolエンドポイント）**: 各NLWebセットアップは**MCPサーバー**としても機能します。これにより、**ツール（「ask」メソッドなど）やデータ**を他のAIシステムと共有できます。実際には、ウェブサイトのコンテンツや機能がAIエージェントによって利用可能になり、ウェブサイトがより広い「エージェントエコシステム」の一部となります。

- **埋め込みモデル**: ウェブサイトのコンテンツを**数値表現（ベクトル）に変換**するために使用されます。これらのベクトルは、コンピュータが比較や検索を行えるように意味を捉えます。特別なデータベースに保存され、ユーザーは使用する埋め込みモデルを選択できます。

- **ベクトルデータベース（検索メカニズム）**: このデータベースは、**ウェブサイトコンテンツの埋め込みを保存**します。誰かが質問をすると、NLWebはベクトルデータベースをチェックして最も関連性の高い情報を迅速に見つけます。類似性でランク付けされた可能性のある回答のリストを提供します。NLWebは、Qdrant、Snowflake、Milvus、Azure AI Search、Elasticsearchなどのさまざまなベクトルストレージシステムと連携します。

### NLWebの例

![NLWeb](../../../translated_images/nlweb-diagram.c1e2390b310e5fe4b245b86690ac6c49c26e355da5ab124128c8675d58cc9b07.ja.png)

旅行予約ウェブサイトを再び考えてみましょう。ただし、今回はNLWebを活用しています。

1. **データ取り込み**: 旅行ウェブサイトの既存の製品カタログ（例: フライトリスト、ホテルの説明、ツアーパッケージ）は、Schema.orgを使用してフォーマットされるか、RSSフィードを介してロードされます。NLWebのツールがこの構造化データを取り込み、埋め込みを作成し、それらをローカルまたはリモートのベクトルデータベースに保存します。

2. **自然言語クエリ（人間）**: ユーザーがウェブサイトを訪れ、メニューをナビゲートする代わりに、チャットインターフェースに「来週、ホノルルでプール付きの家族向けホテルを探してください」と入力します。

3. **NLWebの処理**: NLWebアプリケーションがこのクエリを受け取ります。クエリを理解するためにLLMに送信し、同時にベクトルデータベースを検索して関連するホテルリストを見つけます。

4. **正確な結果**: LLMは、データベースからの検索結果を解釈し、「家族向け」「プール」「ホノルル」といった基準に基づいて最適な一致を特定し、自然言語の応答をフォーマットします。重要なのは、応答がウェブサイトのカタログに基づく実際のホテルを参照しており、架空の情報を避けることです。

5. **AIエージェントとの相互作用**: NLWebがMCPサーバーとして機能するため、外部のAI旅行エージェントもこのウェブサイトのNLWebインスタンスに接

---

**免責事項**:  
この文書は、AI翻訳サービス [Co-op Translator](https://github.com/Azure/co-op-translator) を使用して翻訳されています。正確性を追求しておりますが、自動翻訳には誤りや不正確な部分が含まれる可能性があることをご承知ください。元の言語で記載された文書が正式な情報源とみなされるべきです。重要な情報については、専門の人間による翻訳を推奨します。この翻訳の使用に起因する誤解や誤解釈について、当社は責任を負いません。